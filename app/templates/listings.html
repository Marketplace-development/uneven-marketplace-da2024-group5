{% extends "base.html" %}

{% block title %}Listings - ViaVia{% endblock %}

{% block content %}
<div class="container mt-5">
    <!-- Header -->
    <h1 class="text-primary text-center mb-4">Listings</h1>

    <!-- Search Form -->
    <form action="{{ url_for('main.search') }}" method="GET" class="mb-4">
        <div class="input-group">
            <input 
                type="text" 
                class="form-control" 
                name="query" 
                placeholder="Search Listings" 
                value="{{ request.args.get('query', '') }}" 
                aria-label="Search Listings">
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </form>

    <!-- Filter Form -->
    <form action="{{ url_for('main.filter_listings') }}" method="GET" class="mb-4 p-3 bg-light rounded shadow-sm">
        <div class="row g-3">
            <div class="col-md-4">
                <label for="min_price" class="form-label">Min Price:</label>
                <input 
                    type="number" 
                    class="form-control" 
                    name="min_price" 
                    step="0.5" 
                    value="{{ request.args.get('min_price', '') }}">
            </div>
            <div class="col-md-4">
                <label for="max_price" class="form-label">Max Price:</label>
                <input 
                    type="number" 
                    class="form-control" 
                    name="max_price" 
                    step="0.5" 
                    value="{{ request.args.get('max_price', '') }}">
            </div>
            <div class="col-md-4">
                <label for="category" class="form-label">Category:</label>
                <input 
                    type="text" 
                    class="form-control" 
                    name="category" 
                    value="{{ request.args.get('category', '') }}">
            </div>
        </div>
        <div class="mt-3 text-end">
            <button type="submit" class="btn btn-primary">Filter</button>
        </div>
    </form>

    <!-- Listings -->
    <div class="list-group">
        {% for listing in listings %}
        <a 
            href="{{ url_for('main.view_listing', listing_id=listing.id) }}" 
            class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
            <span>{{ listing.listing_name }}</span>
            <span class="badge bg-primary">${{ listing.price }}</span>
        </a>
        {% else %}
        <div class="alert alert-danger text-center" role="alert">
            No listings available.
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
